/*
* cutlery.js 2.0.2 - https://github.com/lennertderyck/cutleryjs
* Licensed under the GNU GPLv3 license - https://choosealicense.com/licenses/gpl-3.0/#
*
* Copyright (c) 2020 Lennert De Ryck
*/

"use strict";var _index=require("https://unpkg.com/thinid@0.5.1/lib/index.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocalDB=exports.Api=exports.fetchAPI=exports.cookies=exports.getFormData=exports.eventCallback=exports.Element=exports.node=void 0;const node=function(a,b=!1){const c=document.querySelectorAll(a);return!1==b?c[0]:c};exports.node=node;class Element{constructor(a){if("string"!=typeof a)throw new Error("The tagname of this new element is not of the type string");try{this.el=document.createElement(a)}catch(a){console.error("Something went wrong when creating a new element. We logged the error message for you convenience:"),console.log(a)}this.content=""}class(a){var b=this;if("object"!=typeof a)throw new Error("You should use an array for adding classes to an element");try{a.map(function(a){return b.el.classList.add(a)})}catch(a){console.error("Something went wrong when adding classes. We logged this element and the error message for you convenience:"),console.log(a),console.log(this.el)}}attributes(a){var b=this;if("object"!=typeof a)throw new Error("You should use an array for adding attributes to an element");try{a.map(function(a){return b.el.setAttribute(a[0],a[1])})}catch(a){console.error("Something went wrong when adding attribtues. We logged this element and the error message for you convenience:"),console.log(a),console.log(this.el)}}inner(a){this.el.innerHTML=a||this.content}log(){console.log(this.el)}append(a="html body",b="selector"){"string"==typeof a?a=document.querySelector(a):"object"==typeof a&&(a=a);try{a.appendChild(this.el)}catch(a){console.error("Something went wrong when adding an element. You've probably entered a wrong selector or node element. We logged this element and the error message for you convenience:"),console.log(a),console.log(this.el)}}prepend(a="html body",b="selector"){"string"==typeof a?a=document.querySelector(a):"object"==typeof a&&(a=a);try{a.prepend(this.el)}catch(a){console.error("Something went wrong when adding an element. You've probably entered a wrong selector or node element. We logged this element and the error message for you convenience:"),console.log(a),console.log(this.el)}}return(a){return!a||"node"?this.el:"html"==a?this.el.outerHTML:void 0}}exports.Element=Element;const eventCallback=function(a,b,c=!0){let d=null;d=!0==c?event.target.closest(`[data-action="${a}"]`):event.target.closest(a),d&&b(d)};exports.eventCallback=eventCallback;const getFormData=function(a){// https://stackoverflow.com/a/14438954/9357283
const b=new Set,c=new FormData(a),d=new Map,e=a.querySelectorAll("[name]");return e.forEach(function(a){b.add({name:a.getAttribute("name"),type:a.getAttribute("type")||"textarea"})}),b.forEach(function(a){d.set(a.name,"number"==a.type?parseFloat(c.get(a.name)):c.get(a.name))}),d};exports.getFormData=getFormData;const cookies={set(a,b,c){if(c){const a=new Date;a.setTime(a.getTime()+1e3*(60*(60*(24*c))));var d="expires="+a.toGMTString()}else var d="";document.cookie=`${a}=${b}; ${d}; path=/`},get(a){const b=a+"=",d=document.cookie.split(";");for(var e,f=0;f<d.length;f++){for(e=d[f];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}};exports.cookies=cookies;const fetchAPI={async json(a,b={method:"GET"}){try{let c=await fetch(a,b),d=await c.json();return d}catch{throw new Error("Something went really wrong fetching this api",a)}},async text(a,b={method:"GET"}){try{let c=await fetch(a,b),d=await c.text();return d}catch{throw new Error("Something went really wrong fetching this api",a)}}};exports.fetchAPI=fetchAPI;class Api{constructor(a,b={method:"GET"}){this.url=a,this.options=b}async fetch(a=this.options){try{return this.response=await fetch(url,a),this.response}catch{throw new Error("Something went really wrong fetching this api",url)}}async JSON(){return this.data=await this.response.json(),this.data}async TEXT(){return this.data=await this.response.text(),this.data}async HTML(){const a=this.TEXT(),b=new Element("template");return b.inner(a),b}}exports.Api=Api;class LocalDB{constructor(a){this.name=a,this.data=[],!1==this.exist()&&window.localStorage.setItem(a,JSON.stringify({name:this.name,data:this.data}))}getData(){const a=window.localStorage.getItem(this.name);return a?JSON.parse(a).data:"There is no localStorage item with this name"}exist(){const a=window.localStorage.getItem(this.name);return!!a&&a}detatch(){return window.localStorage.removeItem(this.name),console.log(`local database '${this.name}' removed`),this.name}store(a){window.localStorage.setItem(this.name,JSON.stringify({name:this.name,data:a}))}addMeta(a){a.map(function(a){a.__id=(0,_index.thinid)(11)})}add(a,b){const c=this.getData(),d=!1==Array.isArray(a)?[a]:a;this.addMeta(d),this.data=!1==Array.isArray(a)?[...c,...d]:[...c,...d],this.store(this.data),b&&b()}remove(a,b){const c=this.getData(),d=Object.keys(a)[0],e=c.findIndex(function(b){return b[d]==a[d]});c.splice(e,1),this.store(c),b&&b()}item(a){const b=this.getData(),c=Object.keys(a)[0];return b.find(function(b){return b[c]==a[c]})}count(){const a=this.getData();return a.length}empty(){this.store([])}}exports.LocalDB=LocalDB;